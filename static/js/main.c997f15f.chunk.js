(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{129:function(e,t,n){e.exports=n(283)},228:function(e,t){},279:function(e,t,n){},280:function(e,t,n){},281:function(e,t,n){},282:function(e,t,n){},283:function(e,t,n){"use strict";n.r(t);var a,r,i=n(0),o=n.n(i),s=n(45),d=n.n(s),c=n(13),l=n(14),u=n(16),p=n(11),f=n(15),b=n(10),g=n(116),m=n(6),h=n(17),y=n(3),O=n(5),v=n.n(O),x=n(284),j=Object(x.a)((a={},Object(m.a)(a,"ADDRESS_LIST_FETCH",function(e){return Object(y.a)({},e,{isFetching:!0,list:[]})}),Object(m.a)(a,"ADDRESS_LIST_FETCH_SUCCESS",function(e,t){return Object(y.a)({},e,{list:Object(h.a)(t.addressList),isFetching:!1})}),Object(m.a)(a,"ADDRESS_LIST_FETCH_FAIL",function(e){return Object(y.a)({},e,{isFetching:!1})}),a),{list:[],isFetching:!1}),E=(v.a.string,v.a.string,v.a.string,v.a.string,j),I=n(49),w=function(){return(new Date).getUTCMilliseconds()},C=function(e){return e.toArray().map(function(e){var t=e.geometry.getCoordinates().map(function(e){return e.toString()}),n=Object(I.a)(t,2),a=n[0];return{lat:n[1],lng:a,name:e.properties.get("name"),description:e.properties.get("text")}})},_=n(30),S=n.n(_),A=Object(x.a)((r={},Object(m.a)(r,"POINT_ADD",function(e,t){var n=S()(e),a=n.byId,r=t.id;return Object.values(a).filter(function(e){return e.lat===t.address.lat&&e.lng===t.address.lng}).length?Object(y.a)({},n):Object(y.a)({},n,{byId:Object(y.a)({},n.byId,Object(m.a)({},r,Object(y.a)({},t.address,{id:r,isSaving:!1}))),ids:[].concat(Object(h.a)(n.ids),[r])})}),Object(m.a)(r,"POINT_REMOVE",function(e,t){var n=S()(e),a=n.byId,r=n.ids,i=t.id;return r.splice(r.indexOf(i),1),delete a[i],Object(y.a)({},n,{byId:Object(y.a)({},a),ids:Object(h.a)(r)})}),Object(m.a)(r,"POINT_ORDER_CHANGE",function(e,t){var n=S()(e),a=t.oldIndex,r=t.newIndex,i=function(e,t,n){if(t>e.length-1||n>e.length-1)return console.log("Position exceeds array length"),e;var a=Object(h.a)(e),r=a.splice(t,1),i=a.slice(0,n),o=a.slice(n);return[].concat(Object(h.a)(i),Object(h.a)(r),Object(h.a)(o))}(n.ids,a,r);return Object(y.a)({},n,{ids:i})}),Object(m.a)(r,"POINT_POSITION_CHANGE",function(e,t){var n=S()(e),a=t.id;return Object(y.a)({},n,{byId:Object(y.a)({},n.byId,Object(m.a)({},a,Object(y.a)({},n.byId[a],{isSaving:!0})))})}),Object(m.a)(r,"POINT_POSITION_CHANGE_SUCCESS",function(e,t){var n=S()(e),a=t.data,r=t.id,i=n.byId,o=Object(y.a)({},a);return o.id=r,o.lng=o.lng.toString(),o.lat=o.lat.toString(),Object(y.a)({},n,{byId:Object(y.a)({},i,Object(m.a)({},r,Object(y.a)({},o,{isSaving:!1})))})}),r),{byId:{},ids:[]}),P=(v.a.number,v.a.string,v.a.string,v.a.string,v.a.string,v.a.bool,A),k=Object(b.combineReducers)({addresses:E,points:P}),N=function(e){try{var t=localStorage.getItem(e);if(null===t)return;return JSON.parse(t)}catch(n){return}}("map-routes"),L=Object(g.composeWithDevTools)({}),D=Object(b.createStore)(k,N,L());D.subscribe(function(){!function(e,t){try{var n=JSON.stringify(t);localStorage.setItem(e,n)}catch(a){}}("map-routes",D.getState())});var T=D,R=n(8),F=n(19),M=n(29),B=n.n(M),H=n(47),V={center:[55.75,37.57],zoom:9,controls:[],points:{}},z=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state=Object(y.a)({},V,{orderedPoints:[],ids:[]}),n.onDragEnd=function(){var e=Object(H.a)(B.a.mark(function e(t,a){var r,i,o,s,d,c,l,u,p,f,b,g;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.props,i=r.updatePointPosition,o=r.updatePointPositionSuccess,s=r.ymaps,d=Object(I.a)(t.originalEvent.target.geometry._coordinates,2),c=d[0],l=d[1],i(a),e.next=5,s.geocode([c,l]);case 5:u=e.sent,p=u.geoObjects.get(0).properties.get("text"),f=p.split(", "),b=f[f.length-1],g={lng:c,lat:l,name:b,description:p},console.log(g),o(g,a);case 12:case"end":return e.stop()}},e)}));return function(t,n){return e.apply(this,arguments)}}(),n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"getPolylineGeometry",value:function(){return this.state.orderedPoints.map(function(e){return[e.lng,e.lat]})}},{key:"renderPlacemark",value:function(e,t){var n=this,a={geometry:{type:"Point",coordinates:[parseFloat(e.lng),parseFloat(e.lat)]},properties:{iconContent:t+1,hintContent:e.name,balloonContentHeader:e.name,balloonContentBody:e.description},options:{preset:"twirl#redDotIcon",draggable:!0,hintHideTimeout:0},modules:["geoObject.addon.balloon","geoObject.addon.hint"]};return o.a.createElement(F.b,Object.assign({key:e.id,onDragEnd:function(t){return n.onDragEnd(t,e.id)}},a))}},{key:"render",value:function(){var e=this,t=this.props.onMapLoad,n=this.state.orderedPoints;return o.a.createElement(F.a,{state:this.state,defaultState:this.state,width:"100%",height:"100%",onLoad:t,onError:function(e){return console.log(e)}},n.map(function(t,n){return e.renderPlacemark(t,n)}),o.a.createElement(F.c,{geometry:this.getPolylineGeometry(n)}))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.ids,a=e.pointsById,r=[];n.forEach(function(e){r.push(a[e])});var i,o={orderedPoints:r,ids:n};return i=t.ids,e.ids.length>i.length&&(o.center=function(e){var t=e[e.length-1];return[t.lng,t.lat]}(r)),o}}]),t}(o.a.Component);z.defaultProps={pointsById:{},ids:[]};var G={updatePointPosition:function(e){return{type:"POINT_POSITION_CHANGE",id:e}},updatePointPositionSuccess:function(e,t){return{type:"POINT_POSITION_CHANGE_SUCCESS",data:e,id:t}}},U=Object(R.b)(function(e){return{pointsById:e.points.byId,ids:e.points.ids}},G)(Object(F.e)(z)),W=n(118),q=n.n(W),J=n(119),K=n.n(J);function $(){return($=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function Q(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var X=o.a.createElement("g",{fill:"none",fillRule:"evenodd",transform:"translate(1 1)",strokeWidth:2},o.a.createElement("circle",{cx:22,cy:22,r:6.38895,strokeOpacity:0},o.a.createElement("animate",{attributeName:"r",begin:"1.5s",dur:"3s",values:"6;22",calcMode:"linear",repeatCount:"indefinite"}),o.a.createElement("animate",{attributeName:"stroke-opacity",begin:"1.5s",dur:"3s",values:"1;0",calcMode:"linear",repeatCount:"indefinite"}),o.a.createElement("animate",{attributeName:"stroke-width",begin:"1.5s",dur:"3s",values:"2;0",calcMode:"linear",repeatCount:"indefinite"})),o.a.createElement("circle",{cx:22,cy:22,r:14.389,strokeOpacity:0},o.a.createElement("animate",{attributeName:"r",begin:"3s",dur:"3s",values:"6;22",calcMode:"linear",repeatCount:"indefinite"}),o.a.createElement("animate",{attributeName:"stroke-opacity",begin:"3s",dur:"3s",values:"1;0",calcMode:"linear",repeatCount:"indefinite"}),o.a.createElement("animate",{attributeName:"stroke-width",begin:"3s",dur:"3s",values:"2;0",calcMode:"linear",repeatCount:"indefinite"})),o.a.createElement("circle",{cx:22,cy:22,r:4.54142},o.a.createElement("animate",{attributeName:"r",begin:"0s",dur:"1.5s",values:"6;1;2;3;4;5;6",calcMode:"linear",repeatCount:"indefinite"}))),Y=function(e){var t=e.svgRef,n=Q(e,["svgRef"]);return o.a.createElement("svg",$({width:45,height:45,viewBox:"0 0 45 45",stroke:"#000",ref:t},n),X)},Z=o.a.forwardRef(function(e,t){return o.a.createElement(Y,$({svgRef:t},e))}),ee=(n.p,n(2)),te=ee.a.i.withConfig({displayName:"Spinnerstyled__SpinnerIcon",componentId:"sc-170awyp-0"})(["display:block;width:",";height:",";svg{stroke:",";width:100%;height:100%;}"],function(e){return e.large?"100px":"20px"},function(e){return e.large?"100px":"20px"},function(e){return e.color}),ne=function(e){var t=e.large,n=e.color;return o.a.createElement(te,{large:t,color:n,alt:"spinner"},o.a.createElement(Z,null))};ne.defaultProps={large:!1,color:"dodgerblue"};var ae=ne,re=ee.a.div.withConfig({displayName:"AddressInputstyled__AddressInputBlock",componentId:"sc-10sj4ff-0"})(["background-color:#fff;border-radius:8px;padding:5px 10px;border:1px solid #e4e4e4;width:392px;display:flex;flex-direction:row;z-index:3;position:relative;box-shadow:none;transition:ease 0.3s box-shadow;align-items:center;@media screen and (max-width:448px){width:100%;border-radius:0;}> div{flex-grow:1;}"]),ie=ee.a.input.withConfig({displayName:"AddressInputstyled__Input",componentId:"sc-10sj4ff-1"})(["font-size:16px;font-family:'Roboto Slab',serif;border-radius:3px;border:none;height:24px;outline:none;width:100%;box-sizing:border-box;"]),oe=ee.a.span.withConfig({displayName:"AddressInputstyled__EnterButtonIcon",componentId:"sc-10sj4ff-2"})(["position:relative;display:block;border-radius:3px;border:1px solid #ccc;background-color:#fefefe;width:25px;height:20px;&:before,&:after{content:'';position:absolute;}&:before{border-top:3px solid transparent;border-bottom:3px solid transparent;border-right:3px solid #555;left:6px;top:9px;position:absolute;}&:after{width:8px;height:8px;border-right:1px solid #555;border-bottom:1px solid #555;top:4px;left:9px;border-bottom-right-radius:2px;}"]),se=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e))).state={value:""},n.fetchAddressList=function(){var e=Object(H.a)(B.a.mark(function e(t){var a,r,i,o,s,d;return B.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=n.props,r=a.fetchAddressList,i=a.fetchAddressListSuccess,o=n.props.ymaps.geocode,r(),e.next=5,o(t);case 5:s=e.sent,d=C(s.geoObjects),i(d);case 8:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),n.handleInputChange=function(e){e.persist();var t=e.target.value;n.setState({value:t}),n.debouncedFetchAddressList(t)},n.handleKeyDown=function(e){var t=n.props.onSubmit;13===e.keyCode&&(t(),n.clearInputValue())},n.debouncedFetchAddressList=q()(n.fetchAddressList,500),n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"clearInputValue",value:function(){this.setState({value:""})}},{key:"render",value:function(){var e=this.props,t=e.onClickOutside,n=e.isAddressFetching,a=e.isAddressListVisible,r=this.state.value,i=this.handleKeyDown,s=this.handleInputChange,d=!n&&a;return o.a.createElement(re,null,o.a.createElement(K.a,{onOutsideClick:t},o.a.createElement(ie,{"data-e2e-id":"address-input",type:"text",placeholder:"Search...",onChange:s,onKeyDown:i,value:r})),n&&o.a.createElement(ae,null),d&&o.a.createElement(oe,null))}}]),t}(i.Component),de=Object(F.e)(se),ce=n(125),le=function(){return"\n  border-radius: 3px;\n  border: none;\n  height: 24px;\n  width: 24px;\n  outline: none;\n  transition: ease .3s background-color;\n  background-color: #fff;\n  padding: 0;\n\n  &:hover {\n    background-color: ".concat(Object(ce.a)(.05,"#fff"),";\n    cursor: pointer;\n  }\n")},ue=ee.a.li.withConfig({displayName:"AddressItemstyled__AddressItemBlock",componentId:"tr8q9s-0"})(["display:flex;padding:4px;"]),pe=ee.a.span.withConfig({displayName:"AddressItemstyled__ItemName",componentId:"tr8q9s-1"})(["flex-grow:2;cursor:default;padding-left:5px;"]),fe=ee.a.button.withConfig({displayName:"AddressItemstyled__AddButton",componentId:"tr8q9s-2"})(["",""],le),be=function(e){var t=e.address,n=e.handleAddClick;return o.a.createElement(ue,{"data-e2e-id":"address-item"},o.a.createElement(pe,null,t.name),o.a.createElement(fe,{onClick:function(){return n(t,w())}},o.a.createElement("i",{className:"icofont-plus"})))};be.defaultProps={address:{}};var ge=be,me=ee.a.ul.withConfig({displayName:"AddressListstyled__AddressListContainer",componentId:"sc-1uom5j3-0"})(["margin:0 10px;background-color:#fff;border-bottom-left-radius:4px;border-bottom-right-radius:4px;border:1px solid #e4e4e4;position:relative;padding-top:10px;top:-10px;z-index:2;max-height:300px;overflow:auto;display:",";"],function(e){return e.isVisible?"block":"none"}),he=Object(R.b)(function(e){return{addresses:e.addresses.list}},null)(function(e){var t=e.addresses,n=e.isVisible,a=e.addPoint;return o.a.createElement(me,{isVisible:n},t.map(function(e,t){return o.a.createElement(ge,{address:e,key:"address-".concat(t),handleAddClick:a})}))}),ye=ee.a.div.withConfig({displayName:"Addressstyled__AddressBlock",componentId:"sc-7m87v5-0"})(["z-index:2;position:fixed;top:20px;left:20px;@media screen and (max-width:448px){top:0;left:0;width:100%;}"]),Oe=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={isAddressListVisible:!1},n.onClickOutside=function(){n.hideAddressList()},n.onAddressInputSubmit=function(){var e=n.props,t=e.addresses,a=e.addPoint;t.length&&(a(t[0],w()),n.hideAddressList())},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"componentDidUpdate",value:function(e){this.props.addresses.length&&!e.addresses.length&&this.showAddressList()}},{key:"showAddressList",value:function(){this.setState({isAddressListVisible:!0})}},{key:"hideAddressList",value:function(){this.setState({isAddressListVisible:!1})}},{key:"render",value:function(){var e=this.onClickOutside,t=this.onAddressInputSubmit,n=this.props,a=n.fetchAddressList,r=n.fetchAddressListSuccess,i=n.addPoint,s=n.addresses,d=n.isAddressFetching,c=this.state.isAddressListVisible;return o.a.createElement(ye,null,o.a.createElement(de,{fetchAddressList:a,fetchAddressListSuccess:r,onClickOutside:e,isAddressFetching:d,onSubmit:t,isAddressListVisible:c}),o.a.createElement(he,{addresses:s,isVisible:c,addPoint:i}))}}]),t}(i.Component),ve={fetchAddressList:function(){return{type:"ADDRESS_LIST_FETCH"}},fetchAddressListSuccess:function(e){return{type:"ADDRESS_LIST_FETCH_SUCCESS",addressList:e}},addPoint:function(e,t){return{type:"POINT_ADD",address:e,id:t}}},xe=Object(R.b)(function(e){return{addresses:e.addresses.list,isAddressFetching:e.addresses.isFetching}},ve)(Oe),je=n(51),Ee=ee.a.div.withConfig({displayName:"Pointstyled__PointContainer",componentId:"sc-1geppr7-0"})(["padding:5px;display:flex;flex-direction:row;align-items:center;margin-bottom:4px;position:relative;"]),Ie=ee.a.div.withConfig({displayName:"Pointstyled__DragHandle",componentId:"sc-1geppr7-1"})(["position:relative;top:1px;"]),we=ee.a.span.withConfig({displayName:"Pointstyled__PointName",componentId:"sc-1geppr7-2"})(["flex-grow:2;padding:5px;cursor:default;"]),Ce=ee.a.button.withConfig({displayName:"Pointstyled__RemoveButton",componentId:"sc-1geppr7-3"})(["",";"],le),_e=ee.a.i.withConfig({displayName:"Pointstyled__ButtonIcon",componentId:"sc-1geppr7-4"})(["font-size:15px;"]),Se=function(e){var t=e.point,n=e.onPointRemove,a=e.provided;return o.a.createElement(Ee,null,o.a.createElement(Ie,a.dragHandleProps,o.a.createElement("i",{className:"icofont-navigation-menu"})),o.a.createElement(we,null,t.name),t.isSaving?o.a.createElement(ae,null):o.a.createElement(Ce,{onClick:function(){return n(t.id)}},o.a.createElement(_e,{className:"icofont-bin"})))};Se.defaultProps={point:{}};var Ae=Se,Pe=ee.a.div.withConfig({displayName:"PointsListstyled__PointsListContainer",componentId:"sc-1b49gx2-0"})(["min-height:30px;max-height:400px;background-color:#fff;border-radius:8px;border:1px solid #e4e4e4;z-index:1;min-width:200px;padding-right:5px;@media screen and (max-width:448px){width:100%;padding-right:0;max-height:250px;overflow:auto;}"]),ke=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).onDragEnd=function(e){"DROP"===e.reason&&(0,n.props.changePointOrder)({oldIndex:e.source.index,newIndex:e.destination.index,addressId:e.draggableId})},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.onDragEnd,t=this.props,n=t.pointsById,a=t.ids,r=t.removePoint;return a.length?o.a.createElement(je.a,{onDragEnd:e},o.a.createElement(je.c,{droppableId:"points-droppable"},function(e){return o.a.createElement(Pe,Object.assign({ref:e.innerRef},e.droppableProps),a.map(function(e,t){return o.a.createElement(je.b,{key:e,draggableId:e,index:t},function(t){return o.a.createElement("div",Object.assign({ref:t.innerRef},t.draggableProps),o.a.createElement(Ae,{point:n[e],onPointRemove:r,provided:t}))})}),e.placeholder)})):null}}]),t}(i.Component),Ne={removePoint:function(e){return{type:"POINT_REMOVE",id:e}},changePointOrder:function(e){return Object(y.a)({type:"POINT_ORDER_CHANGE"},e)}},Le=Object(R.b)(function(e){return{ids:e.points.ids,pointsById:e.points.byId}},Ne)(ke),De=ee.a.div.withConfig({displayName:"Appstyled__Wrapper",componentId:"sc-1o46p4-0"})(["height:100vh;"]),Te=ee.a.div.withConfig({displayName:"Appstyled__PointsListWrapper",componentId:"sc-1o46p4-1"})(["position:fixed;z-index:1;left:0;top:0;height:100vh;display:flex;align-items:center;padding-left:20px;width:0;@media screen and (max-width:448px){top:auto;bottom:0;height:auto;display:block;width:100%;padding-left:0;}"]),Re=ee.a.div.withConfig({displayName:"Appstyled__LoadingOverlay",componentId:"sc-1o46p4-2"})(["position:fixed;top:0;left:0;width:100vw;height:100vh;display:flex;align-items:center;justify-content:center;background-color:#fff;z-index:5;"]),Fe=function(e){function t(){var e,n;Object(c.a)(this,t);for(var a=arguments.length,r=new Array(a),i=0;i<a;i++)r[i]=arguments[i];return(n=Object(u.a)(this,(e=Object(p.a)(t)).call.apply(e,[this].concat(r)))).state={isMapLoaded:!1},n.handleMapLoad=function(){n.setState({isMapLoaded:!0})},n}return Object(f.a)(t,e),Object(l.a)(t,[{key:"render",value:function(){var e=this.state.isMapLoaded;return o.a.createElement(o.a.Fragment,null,!e&&o.a.createElement(Re,null,o.a.createElement(ae,{large:!0})),o.a.createElement(R.a,{store:T},o.a.createElement(F.d,{query:{ns:"use-load-option",apikey:"7547cd62-6ddd-4fe8-bbef-55ea5c7e70bf",load:"geocode"}},o.a.createElement(De,null,o.a.createElement(U,{onMapLoad:this.handleMapLoad}),e&&o.a.createElement(xe,null),o.a.createElement(Te,null,o.a.createElement(Le,null))))))}}]),t}(i.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));n(279),n(280),n(281),n(282);d.a.render(o.a.createElement(Fe,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[129,1,2]]]);
//# sourceMappingURL=main.c997f15f.chunk.js.map